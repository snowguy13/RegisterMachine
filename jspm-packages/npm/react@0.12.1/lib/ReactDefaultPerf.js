/* */
"format cjs";"use strict";function roundFloat(e){return Math.floor(100*e)/100}function addValue(e,t,n){e[t]=(e[t]||0)+n}var DOMProperty=require("./DOMProperty"),ReactDefaultPerfAnalysis=require("./ReactDefaultPerfAnalysis"),ReactMount=require("./ReactMount"),ReactPerf=require("./ReactPerf"),performanceNow=require("./performanceNow"),ReactDefaultPerf={_allMeasurements:[],_mountStack:[0],_injected:!1,start:function(){ReactDefaultPerf._injected||ReactPerf.injection.injectMeasure(ReactDefaultPerf.measure),ReactDefaultPerf._allMeasurements.length=0,ReactPerf.enableMeasure=!0},stop:function(){ReactPerf.enableMeasure=!1},getLastMeasurements:function(){return ReactDefaultPerf._allMeasurements},printExclusive:function(e){e=e||ReactDefaultPerf._allMeasurements;var t=ReactDefaultPerfAnalysis.getExclusiveSummary(e);console.table(t.map(function(e){return{"Component class name":e.componentName,"Total inclusive time (ms)":roundFloat(e.inclusive),"Exclusive mount time (ms)":roundFloat(e.exclusive),"Exclusive render time (ms)":roundFloat(e.render),"Mount time per instance (ms)":roundFloat(e.exclusive/e.count),"Render time per instance (ms)":roundFloat(e.render/e.count),Instances:e.count}}))},printInclusive:function(e){e=e||ReactDefaultPerf._allMeasurements;var t=ReactDefaultPerfAnalysis.getInclusiveSummary(e);console.table(t.map(function(e){return{"Owner > component":e.componentName,"Inclusive time (ms)":roundFloat(e.time),Instances:e.count}})),console.log("Total time:",ReactDefaultPerfAnalysis.getTotalTime(e).toFixed(2)+" ms")},getMeasurementsSummaryMap:function(e){var t=ReactDefaultPerfAnalysis.getInclusiveSummary(e,!0);return t.map(function(e){return{"Owner > component":e.componentName,"Wasted time (ms)":e.time,Instances:e.count}})},printWasted:function(e){e=e||ReactDefaultPerf._allMeasurements,console.table(ReactDefaultPerf.getMeasurementsSummaryMap(e)),console.log("Total time:",ReactDefaultPerfAnalysis.getTotalTime(e).toFixed(2)+" ms")},printDOM:function(e){e=e||ReactDefaultPerf._allMeasurements;var t=ReactDefaultPerfAnalysis.getDOMSummary(e);console.table(t.map(function(e){var t={};return t[DOMProperty.ID_ATTRIBUTE_NAME]=e.id,t.type=e.type,t.args=JSON.stringify(e.args),t})),console.log("Total time:",ReactDefaultPerfAnalysis.getTotalTime(e).toFixed(2)+" ms")},_recordWrite:function(e,t,n,r){var o=ReactDefaultPerf._allMeasurements[ReactDefaultPerf._allMeasurements.length-1].writes;o[e]=o[e]||[],o[e].push({type:t,time:n,args:r})},measure:function(e,t,n){return function(){for(var r=[],o=0,a=arguments.length;a>o;o++)r.push(arguments[o]);var i,s,u;if("_renderNewRootComponent"===t||"flushBatchedUpdates"===t)return ReactDefaultPerf._allMeasurements.push({exclusive:{},inclusive:{},render:{},counts:{},writes:{},displayNames:{},totalTime:0}),u=performanceNow(),s=n.apply(this,r),ReactDefaultPerf._allMeasurements[ReactDefaultPerf._allMeasurements.length-1].totalTime=performanceNow()-u,s;if("ReactDOMIDOperations"===e||"ReactComponentBrowserEnvironment"===e){if(u=performanceNow(),s=n.apply(this,r),i=performanceNow()-u,"mountImageIntoNode"===t){var c=ReactMount.getID(r[1]);ReactDefaultPerf._recordWrite(c,t,i,r[0])}else"dangerouslyProcessChildrenUpdates"===t?r[0].forEach(function(e){var t={};null!==e.fromIndex&&(t.fromIndex=e.fromIndex),null!==e.toIndex&&(t.toIndex=e.toIndex),null!==e.textContent&&(t.textContent=e.textContent),null!==e.markupIndex&&(t.markup=r[1][e.markupIndex]),ReactDefaultPerf._recordWrite(e.parentID,e.type,i,t)}):ReactDefaultPerf._recordWrite(r[0],t,i,Array.prototype.slice.call(r,1));return s}if("ReactCompositeComponent"!==e||"mountComponent"!==t&&"updateComponent"!==t&&"_renderValidatedComponent"!==t)return n.apply(this,r);var l="mountComponent"===t?r[0]:this._rootNodeID,p="_renderValidatedComponent"===t,d="mountComponent"===t,f=ReactDefaultPerf._mountStack,m=ReactDefaultPerf._allMeasurements[ReactDefaultPerf._allMeasurements.length-1];if(p?addValue(m.counts,l,1):d&&f.push(0),u=performanceNow(),s=n.apply(this,r),i=performanceNow()-u,p)addValue(m.render,l,i);else if(d){var h=f.pop();f[f.length-1]+=i,addValue(m.exclusive,l,i-h),addValue(m.inclusive,l,i)}else addValue(m.inclusive,l,i);return m.displayNames[l]={current:this.constructor.displayName,owner:this._owner?this._owner.constructor.displayName:"<root>"},s}}};module.exports=ReactDefaultPerf;
//# sourceMappingURL=ReactDefaultPerf.js.map