/* */
"format cjs";function visitStructuredVariable(e,t,r,o){return utils.append(getTmpVar(o.localScope.tempVarIndex)+"=",o),utils.catchupWhiteSpace(t.init.range[0],o),e(t.init,r,o),utils.catchup(t.init.range[1],o),utils.append(","+getDestructuredComponents(t.id,o),o),o.localScope.tempVarIndex++,!1}function isStructuredPattern(e){return e.type===Syntax.ObjectPattern||e.type===Syntax.ArrayPattern}function getDestructuredComponents(e,t){for(var r=t.localScope.tempVarIndex,o=[],n=getPatternItems(e),s=0;s<n.length;s++){var a=n[s];if(a)if(a.type!==Syntax.SpreadElement)if(a.type!==Syntax.SpreadProperty){var i=getPatternItemAccessor(e,a,r,s),c=getPatternItemValue(e,a);o.push(c.type===Syntax.Identifier?c.name+"="+i:getInitialValue(++t.localScope.tempVarIndex,i)+","+getDestructuredComponents(c,t))}else{var u=restPropertyHelpers.renderRestExpression(getTmpVar(r),n);o.push(a.argument.name+"="+u)}else o.push(a.argument.name+"=Array.prototype.slice.call("+getTmpVar(r)+","+s+")")}return o.join(",")}function getPatternItems(e){return e.properties||e.elements}function getPatternItemAccessor(e,t,r,o){var n=getTmpVar(r);return e.type===Syntax.ObjectPattern?reservedWordsHelper.isReservedWord(t.key.name)?n+'["'+t.key.name+'"]':n+"."+t.key.name:n+"["+o+"]"}function getPatternItemValue(e,t){return e.type===Syntax.ObjectPattern?t.value:t}function getInitialValue(e,t){return getTmpVar(e)+"="+t}function getTmpVar(e){return"$__"+e}function visitStructuredAssignment(e,t,r,o){var n=t.expression;return utils.append("var "+getTmpVar(o.localScope.tempVarIndex)+"=",o),utils.catchupWhiteSpace(n.right.range[0],o),e(n.right,r,o),utils.catchup(n.right.range[1],o),utils.append(","+getDestructuredComponents(n.left,o)+";",o),utils.catchupWhiteSpace(t.range[1],o),o.localScope.tempVarIndex++,!1}function visitStructuredParameter(e,t,r,o){return utils.append(getTmpVar(getParamIndex(t,r)),o),utils.catchupWhiteSpace(t.range[1],o),!0}function getParamIndex(e,t){for(var r=t[0],o=0,n=0;n<r.params.length;n++){var s=r.params[n];if(s===e)break;isStructuredPattern(s)&&o++}return o}function isFunctionNode(e){return e.type==Syntax.FunctionDeclaration||e.type==Syntax.FunctionExpression||e.type==Syntax.MethodDefinition||e.type==Syntax.ArrowFunctionExpression}function visitFunctionBodyForStructuredParameter(e,t,r,o){var n=r[0];return utils.catchup(n.body.range[0]+1,o),renderDestructuredComponents(n,o),n.rest&&utils.append(restParamVisitors.renderRestParamSetup(n),o),!0}function renderDestructuredComponents(e,t){for(var r=[],o=0;o<e.params.length;o++){var n=e.params[o];isStructuredPattern(n)&&(r.push(getDestructuredComponents(n,t)),t.localScope.tempVarIndex++)}r.length&&utils.append("var "+r.join(",")+";",t)}var Syntax=require("esprima-fb").Syntax,utils=require("../src/utils"),reservedWordsHelper=require("./reserved-words-helper"),restParamVisitors=require("./es6-rest-param-visitors"),restPropertyHelpers=require("./es7-rest-property-helpers");visitStructuredVariable.test=function(e){return e.type===Syntax.VariableDeclarator&&isStructuredPattern(e.id)},visitStructuredAssignment.test=function(e){return e.type===Syntax.ExpressionStatement&&e.expression.type===Syntax.AssignmentExpression&&isStructuredPattern(e.expression.left)},visitStructuredParameter.test=function(e,t){return isStructuredPattern(e)&&isFunctionNode(t[0])},visitFunctionBodyForStructuredParameter.test=function(e,t){return e.type===Syntax.BlockStatement&&isFunctionNode(t[0])},exports.visitorList=[visitStructuredVariable,visitStructuredAssignment,visitStructuredParameter,visitFunctionBodyForStructuredParameter],exports.renderDestructuredComponents=renderDestructuredComponents;
//# sourceMappingURL=es6-destructuring-visitors.js.map